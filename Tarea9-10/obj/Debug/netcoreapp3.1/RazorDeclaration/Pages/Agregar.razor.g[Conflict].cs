#pragma checksum "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\Pages\Agregar.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "1aa700fa9df64b1f87c398d7b8651cde56fd7b97"
// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace Tarea9_10.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\_Imports.razor"
using Tarea9_10;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\_Imports.razor"
using Tarea9_10.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\Pages\Agregar.razor"
using Tarea9_10.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\Pages\Agregar.razor"
using BlazorInputFile;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\Pages\Agregar.razor"
using System.IO;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/agregar")]
    public partial class Agregar : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 412 "e:\ITLA\ITLA\6to cuatri\Programacion III\Tarea9-10\Tarea9-10\Pages\Agregar.razor"
       
    IFileListEntry file;
    private bool Pastor_check, Anciano_check, Diacono_check, Misionero_check, Escuela_Dominical_check,
                 Jovenes_check, Caballeros_check, Damas_check, Ninnos_check, Matrimonios_check, Grupo_check;
    private string message;

    protected override async Task OnInitializedAsync()
    {
        persona_service._countries = await Http.GetJsonAsync<List<Country>>("https://restcountries.eu/rest/v2/all");
        await deo_service.GetDatosEclesiasticosOcupacionsAsync();
    }

    private async Task HandleFileSelection(IFileListEntry[] files)
    {
        if (files.Count() > 0)
        {
            file = files.FirstOrDefault();
            using (var ms = new MemoryStream())
            {
                await file.Data.CopyToAsync(ms);
                persona_service._persona.Foto = ms.ToArray();
            }
        }
    }

    public byte[] getImage(string sBase64String)
    {
        byte[] bytes = null;
        if (sBase64String != null)
        {
            bytes = Convert.FromBase64String(sBase64String);
        }

        return bytes;
    }

    private async Task AgregarPersona()
    {
        if(persona_service._datosCiviles.Tienes_Hijos == "No")
        {
            persona_service._datosCiviles.Cantidad_Hijos = 0;
        }
        if(persona_service._datosEclesiasticos.Ha_Disiciplinado == "No")
        {
            persona_service._datosEclesiasticos.Cantidad_Disciplinado = 0;
        }

        if(persona_service._persona.Sexo == null)
        {
            message = "Favor de seleccionar un sexo";
        }
        else if(persona_service._persona.Documento_Identidad == null)
        {
            message = "Favor de seleccionar un tipo de documento";
        }
        else if(persona_service._datosCiviles.Tienes_Hijos == null)
        {
            message = "Favor de seleccionar si tienes hijos o no";
        }
        else if(persona_service._datosCiviles.Suspension_institucion == null)
        {
            message = "Favor de seleccionar si ha sido expulsado o no";
        }
        else if(persona_service._datosEclesiasticos.Denominacion == null)
        {
            message = "Favor de seleccionar la denominacion que perteneces";
        }
        else if(persona_service._datosEclesiasticos.Ha_Disiciplinado == null)
        {
            message = "Favor de seleccionar si ha sido disciplinado o no";
        }
        else if(persona_service._datosEclesiasticos.Estas_Consciente == null)
        {
            message = "Favor de seleccionar si cuenta con el respaldo de sus autoridades eclesiÃ¡sticas para realizar estos estudios";
        }
        else
        {
            persona_service._persona.DatosCiviles = persona_service._datosCiviles;
            persona_service._persona.DatosEclesiasticos = persona_service._datosEclesiasticos;
            persona_service._persona.Usuarios = persona_service._usuario;
            await persona_service.AddPersonaAsync(persona_service._persona);
            datosEclesiasticos_service._datosEclesiasticos = await datosEclesiasticos_service.GetDatosEclesiasticosAsync();
            foreach (var i in deo_service._datosParaBD)
            {
                i.DatosEclesiasticosId = datosEclesiasticos_service._datosEclesiasticos.Max(x => x.PersonaId);
                await deo_service.AddDatosEclesiasticosOcupacionAsync(i);
            }
        }
    }

    private void AgregarEclesiasticoOcupacion(int ocupacionId)
    {
        deo_service._eclesiasticosOcupacion = new DatosEclesiasticosOcupacion();
        //deo_service._eclesiasticosOcupacion.DatosEclesiasticosId = persona_service._personas.Max(x => x.PersonaId) + 1;
        deo_service._eclesiasticosOcupacion.OcupacionId = ocupacionId;
        deo_service._datosParaBD.Add(deo_service._eclesiasticosOcupacion);

    }

    private void RemoverEclesiasticoOcupacion(int ocupacionId)
    {
        //deo_service._eclesiasticosOcupaciones = deo_service._eclesiasticosOcupaciones.Where(x => x.OcupacionId == ocupacionId).ToList();
        deo_service._eclesiasticosOcupacion = deo_service._datosParaBD.FirstOrDefault(y => y.OcupacionId == ocupacionId);
        deo_service._datosParaBD.Remove(deo_service._eclesiasticosOcupacion);
    }

    private void CheckChange(int ocupacionId)
    {
        switch(ocupacionId){
            case 1:
                if (Pastor_check)
                {
                    RemoverEclesiasticoOcupacion(ocupacionId);
                    Pastor_check = false;
                }
                else if (!Pastor_check)
                {
                    AgregarEclesiasticoOcupacion(ocupacionId);
                    Pastor_check = true;
                }
                break;
            case 2:
                if (Anciano_check)
                {
                    RemoverEclesiasticoOcupacion(ocupacionId);
                    Anciano_check = false;
                }
                else if (!Anciano_check)
                {
                    AgregarEclesiasticoOcupacion(ocupacionId);
                    Anciano_check = true;
                }
                break;
            case 3:
                if (Diacono_check)
                {
                    RemoverEclesiasticoOcupacion(ocupacionId);
                    Diacono_check = false;
                }
                else if (!Diacono_check)
                {
                    AgregarEclesiasticoOcupacion(ocupacionId);
                    Diacono_check = true;
                }
                break;
            case 4:
                if (Misionero_check)
                {
                    RemoverEclesiasticoOcupacion(ocupacionId);
                    Misionero_check = false;
                }
                else if (!Misionero_check)
                {
                    AgregarEclesiasticoOcupacion(ocupacionId);
                    Misionero_check = true;
                }
                break;
            case 5:
                if (Escuela_Dominical_check)
                {
                    RemoverEclesiasticoOcupacion(ocupacionId);
                    Escuela_Dominical_check = false;
                }
                else if (!Escuela_Dominical_check)
                {
                    AgregarEclesiasticoOcupacion(ocupacionId);
                    Escuela_Dominical_check = true;
                }
                break;
            case 6:
                if (Jovenes_check)
                {
                    RemoverEclesiasticoOcupacion(ocupacionId);
                    Jovenes_check = false;
                }
                else if (!Jovenes_check)
                {
                    AgregarEclesiasticoOcupacion(ocupacionId);
                    Jovenes_check = true;
                }
                break;
            case 7:
                if (Caballeros_check)
                {
                    RemoverEclesiasticoOcupacion(ocupacionId);
                    Caballeros_check = false;
                }
                else if (!Caballeros_check)
                {
                    AgregarEclesiasticoOcupacion(ocupacionId);
                    Caballeros_check = true;
                }
                break;
            case 8:
                if (Damas_check)
                {
                    RemoverEclesiasticoOcupacion(ocupacionId);
                    Damas_check = false;
                }
                else if (!Damas_check)
                {
                    AgregarEclesiasticoOcupacion(ocupacionId);
                    Damas_check = true;
                }
                break;
            case 9:
                if (Ninnos_check)
                {
                    RemoverEclesiasticoOcupacion(ocupacionId);
                    Ninnos_check = false;
                }
                else if (!Ninnos_check)
                {
                    AgregarEclesiasticoOcupacion(ocupacionId);
                    Ninnos_check = true;
                }
                break;
            case 10:
                if (Matrimonios_check)
                {
                    RemoverEclesiasticoOcupacion(ocupacionId);
                    Matrimonios_check = false;
                }
                else if (!Matrimonios_check)
                {
                    AgregarEclesiasticoOcupacion(ocupacionId);
                    Matrimonios_check = true;
                }
                break;
            case 11:
                if (Grupo_check)
                {
                    RemoverEclesiasticoOcupacion(ocupacionId);
                    Grupo_check = false;
                }
                else if (!Grupo_check)
                {
                    AgregarEclesiasticoOcupacion(ocupacionId);
                    Grupo_check = true;
                }
                break;
        }
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private HttpClient Http { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private DatosEclesiasticosServices datosEclesiasticos_service { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private D_E_OServices deo_service { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private PersonaServices persona_service { get; set; }
    }
}
#pragma warning restore 1591
